table embeddings :
1.Dataset prd_optumrx_orxfdmprdsa.rag.actuals_vs_forecast_analysis. Ledger-level financials for actuals, forecast, budget. Best for trend and mix across time, line_of_business, and product categories; not claim-level. Metrics: revenue, cogs, sg&a, ioi, membership, total_prescriptions, adjusted_scripts, 30_day_scripts, 90_day_scripts. Attributes: ledger, metric_type, line_of_business, product_category, product_sub_category_lvl_1, product_sub_category_lvl_2, transaction_date, year, month, quarter

2.Dataset prd_optumrx_orxfdmprdsa.rag.claim_transaction_for_pharmacy_pbm. Claim-level transactions with submit_date, claim identifiers and status, plus client/carrier/account/group, pharmacy, and drug attributes. Suitable for utilization and financial analyses including revenue/expense/WAC/AWP, revenue per script, and GDR. Metrics: revenue, expense, wac, awp, unadjusted_scripts, adjusted_scripts, 30_day_scripts, 90_day_scripts, revenue_per_script, gdr. Attributes: product_category, claim_nbr, claim_seq_nbr, claim_status_code, line_of_business, line_of_business_desc, carrier_id, account_id, group_id, client_id, client_name, pharmacy_name, pharmacy_npi_no, drug_name, therapy_class_name, brand_vs_generic_ind, gpi_no, ndc_code, DRUG_MANUFCTR_NM, state_code, client_type, submit_date, year, month, quarter,member date of birth and sex


but LLM sees the below :
{"table_name":"prd_optumrx_orxfdmprdsa.rag.actuals_vs_forecast_analysis","description":"This table contains ledger-level financial data including actuals, forecasts, and budget figures. It supports comparative analysis across time periods and tracks performance at the line-of-business level.","useful_for":["monthly actuals analysis","actuals vs forecast vs budget comparison","line-of-business level tracking"],"not_useful_for":["rate_analysis","claim-level analysis","daily granularity","client-level insights"],"metrics":["revenue","expense","cogs","sg&a","ioi","membership","unadjusted_scripts","adjusted_scripts","30_day_scripts","90_day_scripts","volume"],"attributes":{"ledger":"string","line_of_business":"string","transaction_date":"date","year":"integer","month":"integer","quarter":"integer","state_cd":"string"},"time_grains":["monthly","quarterly","yearly"]}

{"table_name":"prd_optumrx_orxfdmprdsa.rag.claim_transaction_for_pharmacy_pbm","description":"Claim-level dataset supporting financial and utilization analysis across client, pharmacy, and drug dimensions. Enables variance tracking by therapy class, manufacturer, and other attributes, with daily granularity and derived metrics like revenue per script and GDR.","useful_for":["claim-level financial analysis","client-level analysis","drug and therapy class performance","manufacturer-level insights","revenue per script and GDR metrics","line-of-business tracking","daily and monthly trend analysis","rate analysis"],"not_useful_for":["budget-level summaries","forecast comparisons","aggregated financial reporting without claim-level detail"],"metrics":["revenue","expense","cogs","wac","awp","unadjusted_scripts","adjusted_scripts","30_day_scripts","90_day_scripts","revenue_per_script","gdr","volume"],"attributes":{"claim_nbr":"string","submit_date":"date","client_id":"string","pharmacy_npi_no":"string","drug_name":"string","therapy_class_name":"string","drug_manufctr_nm":"string","line_of_business":"string","state_cd":"string","brand_vs_generic":"string","client_type":"string","gpi_no":"string","pharmacy_name":"string","pharmacy_type":"string","carrier_id":"string","member_date_of_birth":"date","member_sex":"string"},"time_grains":["daily","monthly","quarterly","yearly"]}

after selection table metadata will be used :
{"table_name":"prd_optumrx_orxfdmprdsa.rag.actuals_vs_forecast_analysis","Table levl description":"Ledger-level financial dataset for actuals, forecast, budget analysis. Best for trend/mix across time, LOB level","columns":[{"column_name":"ledger","description":"Ledger type for the record. Values: 8+4 Forecast, 2+10 Forecast, 5+7 Forecast, GAAP called as Actuals, BUDGET. Used to distinguish actuals from forecast or budget data for variance analysis. If the user does not provide a forecast value, the system will default to the most current forecast cycle based on the latest closed month (e.g., 8+4 when eight months of actuals are available). Only one forecast type will be applied by default.","distinct_values":["8+4","2+10","5+7","GAAP","BUDGET"]},{"column_name":"metric_type","description":"Contains important metric types such as Unadjusted Scripts, Adjusted Scripts, 30 Day Scripts, 90 Day Scripts, Revenues, COGS Post Reclass, SG&A Post Reclass, IOI, and Total Membership. Even when product category is mentioned in the user question and they are asking for overall comparisons between actuals vs forecast vs budget or actuals alone, always include a GROUP BY clause on the metric_type column to ensure accurate results. If the user asks for a specific metric type, use it in the filter clause. Note that Unadjusted Scripts should be used for calculation if the user simply asks for volume or total scripts","distinct_values":["Unadjusted Scripts","Adjusted Scripts","30 Day Scripts","90 Day Scripts","Revenues","COGS Post Reclass","SG&A Post Reclass","IOI","Total Membership"]},{"column_name":"line_of_business","description":"Business or customer segment.C&S (Community & State), E&I (Employer & Individual), M&R(Medicare & Retirement), Optum, External. Commonly used for portfolio or market-share breakdowns.","distinct_values":["C&S","E&I","M&R","Rev Reclass","External","Optum"]},{"column_name":"product_category","description":"High-level category of products or services.Home Delivery called as HDP and Specialty called as SP","distinct_values":["PBM","Home Delivery","Other Products","Community Pharmacies","Workers Comp","Specialty","RVOH"]},{"column_name":"product_sub_category_lvl_1","description":"First-level subcategory under product_category.","distinct_values":["Home Delivery","Specialty","Core PBM","Other Products","Community Pharmacies","RVOH","Hospice","Workers Comp"]},{"column_name":"product_sub_category_lvl_2","description":"Second-level subcategory for more granularity.","distinct_values":["divvyDOSE","Retail Other","GPO","Optum Store","Infusion","Unknown","Workers Comp","Healthline/Healthgrades","Core HDP","CP Core","Mfr Discount","Hospice","RVOH Corp","Core Specialty","Prior Auth","Distribution","Frontier","PharmScript","Retail","Prevention","CPS Solutions","Nuvaila","Admin Fees","Optum Perks","Other Products"]},{"column_name":"transaction_date","description":"Exact transaction date (YYYY-MM-DD). Supports daily, monthly, quarterly, and annual trend analysis."},{"column_name":"year","description":"Four-digit year of the transaction."},{"column_name":"month","description":"Numeric month of the transaction (1-12)."},{"column_name":"quarter","description":"Quarter of the transaction (Q1-Q4)."},{"column_name":"amount_or_count","description":"Contains either amount or count values for each metric type, and these must not be aggregated (e.g., summed) without applying appropriate filters or grouping by the metric_type column. The metric_type column includes distinct values such as Unadjusted Scripts, Adjusted Scripts, 30 Day Scripts, 90 Day Scripts, Revenues, COGS Post Reclass, SG&A Post Reclass, IOI, and Total Membership. Even when attributes like product_category are present in the user question, any calculation involving actuals or forecast comparisons must include a GROUP BY metric_type clause to ensure accurate results."}],"special_table_level_instruction":"If the user mentions Specialty, Home Delivery, and PBM together, do not apply any filters on product_category. If the user mentions PBM alone, also do not apply any filters on product_category while building SQL."}


{"table_name":"prd_optumrx_orxfdmprdsa.rag.claim_transaction_for_pharmacy_pbm","Table levl description":"Claim-level dataset with identifiers, submit dates, claim status, client/carrier/account/group, pharmacy, and drug attributes and variance analysis at drug, therapy class, manufacturer, and other attributes level. Supports utilization and financial analyses (revenue/expense/WAC/AWP), plus derived metrics like revenue per script and GDR.","columns":[{"column_name":"product_category","description":"Indicates the category of product or service for each claim. Distinct values: PBM, Home Delivery (HDP), and Specialty (SP)","distinct_values":["PBM","Home Delivery","Specialty"]},{"column_name":"claim_nbr","description":"Contains unique claim numbers used to identify individual claims in the dataset. Do not use for any calculation; use unadjusted script count for claim counts"},{"column_name":"claim_seq_nbr","description":"Sequence of transactions within the same claim_nbr (e.g., original, reversal). Not used for aggregations or script counts."},{"column_name":"claim_status_code","description":"Processing status of the claim. For utilization/financial metrics use P (Paid)and X (Reveresed). Paid and reversed together reflect net activity.Always Include P,X for derivation.","distinct_values":["P","X"]},{"column_name":"line_of_business","description":"Contains line of business (LOB) identifier such as External,C&S,E&I FI,E&I ASO,PDP,MAPD,E&I UMR and when the user asks plainly external then use this column for filtering and is distinct from client type .","distinct_values":["E&I FI","E&I ASO","C&S","PDP","MAPD","E&I UMR","External"]},{"column_name":"line_of_business_desc","description":"Contains detailed descriptive name of the line of business","distinct_values":["Employer & Individual - United Medical Resources","Medicare Advantage Prescription Drug","Prescription Drug Plan","Others","Community & State","Employer & Individual - Fully Insured","Employer & Individual - Administrative Services Only","External"]},{"column_name":"carrier_id","description":"Identifier of the insurance carrier administering the plan."},{"column_name":"account_id","description":"Client or employer account identifier under which the policy is issued."},{"column_name":"group_id","description":"Group/subgroup within the account; used for sub-client analysis."},{"column_name":"year","description":"Calendar year of claim submission; supports YoY comparisons."},{"column_name":"month","description":"Calendar month of submission; it has numerical value (1-12)."},{"column_name":"quarter","description":"Calendar quarter; supports quarter-over-quarter analysis.contains Q1,Q2,Q3,Q4"},{"column_name":"submit_date","description":"Exact claim submission date. Use for daily trending and time-window filters."},{"column_name":"pharmacy_name","description":"Dispensing pharmacy/provider name; used for provider-level performance."},{"column_name":"pharmacy_npi_no","description":"National Provider Identifier (NPI) of the dispensing pharmacy/provider."},{"column_name":"unadjusted_script_count","description":"Raw script/claim count per event. Use for total volume and as the denominator for revenue_per_script."},{"column_name":"90_days_script_count","description":"Count of 90-day prescriptions; useful for mail-order and adherence analyses."},{"column_name":"30_days_script_count","description":"Count of 30-day prescriptions; complements 90-day for supply-mix insights."},{"column_name":"adjusted_script_count","description":"adjusted script count and should not be used for raw script count or revenue per script analysis."},{"column_name":"revenue_amt","description":"Revenue recognized for the claim. Use with unadjusted_script_count to derive revenue_per_script."},{"column_name":"expense_amt","description":"Expense/cost of goods sold for the claim. Pairs with revenue_amt for margin views."},{"column_name":"wac_amount","description":"Wholesale Acquisition Cost reference for the dispensed drug; used in pricing/cost analytics."},{"column_name":"awp_cost_amount","description":"Average Wholesale Price reference for the dispensed drug; used in pricing/cost analytics."},{"column_name":"client_id","description":"This contain unique client id."},{"column_name":"client_name","description":"This contains client description. Return alongside client_id for user-facing reports."},{"column_name":"drug_name","description":"Name of the dispensed drug; use for molecule-level trends and financials."},{"column_name":"therapy_class_name","description":"Therapeutic class of the drug. Choose class or specific drug based on the question. sample therapy class names are Oncology,GLP-1 Receptor Agonists,SGLT-2 Inhibitors & Combos,GLP-1 Anti-Obesity Agents.if the user is asking generically GLP-1 then use like operator to get all the GLP-1 related information"},{"column_name":"brand_vs_generic_ind","description":"Product type indicator. Drives brand/generic mix and Generic Dispense Rate","distinct_values":["Brand","Generic"]},{"column_name":"gpi_no","description":"Generic Product Identifier; standardized drug classification used for grouping."},{"column_name":"revenue_per_script",


{"table_name":"prd_optumrx_orxfdmprdsa.rag.claim_transaction_for_pharmacy_pbm","purpose":"Claim-level pharmacy transactions with detailed drug, client, and pharmacy attributes. Individual claim records with payment status for utilization and financial analysis.","core_capabilities":"revenue per script analysis, drug utilization trending, therapy class performance (GLP-1, SGLT-2, Oncology), generic dispense rate (GDR), pharmacy network analysis, client-level metrics, brand vs generic mix, claim status tracking","key_measures":["revenue","expense","WAC","AWP","unadjusted scripts","adjusted scripts","30-day scripts","90-day scripts","revenue per script","volume","Generic dispensing ratio/GDR"],"key_dimensions":["claim identifiers","claim status","client id/Client name/Client type","carrier/account/group/CAG","pharmacy name/NPI/Pharmacy type","drug name/ NDC Code","therapy class","GPI","line of business","brand vs generic","product category","state code","member date of birth","member sex","submit date","year","month","quarter"],"query_patterns":["claim-level financial analysis","client-level analysis","drug and therapy class performance","manufacturer-level insights","revenue per script and GDR metrics","line-of-business tracking","daily and monthly trend analysis","rate analysis","pharmacy performance","member usage analysis"],"not_suitable_for":["budget planning","forecast generation","ledger-level summaries"],"grain":"claim_transaction","temporal":"daily via submit_date"}


{"table_name":"prd_optumrx_orxfdmprdsa.rag.actuals_vs_forecast_analysis","purpose":"Ledger-level financial data for actuals, forecast, and budget analysis. Aggregated financial metrics for forecast analysis and planning at LOB level.","key_measures":["revenue","IOI","total membership","unadjusted scripts","adjusted scripts","30-day scripts","90-day scripts","amount or count","expense","volume"],"key_dimensions":["ledger type","line of business","product category","product subcategory level 1","product subcategory level 2","transaction date","year","month","quarter"],"query_patterns":["actuals vs forecast","budget comparison"],"not_suitable_for":["claim-level analysis","daily granularity","client-specific analysis"],"grain":"aggregated_metrics","temporal":"monthly/quarterly/yearly via transaction_date"}


