'Revenue Anlaysis','Ledger-Claims Level','This contains knowledge about revenue analysis at ledger and claim level attributes which can be used for drillthrough',
  '{"analysis_config":{"version":3,"description":"Revenue analysis playbook with two independent datasets: Ledger Overview and Claims Drivers. Each dataset includes columns, date, metrics, group sets, sample questions, and LLM instructions (recipes + parameters only).","datasets":[{"id":"ledger_overview","name":"Revenue - Financial Ledger Overview","table":"prd_optumrx_orxfdmprdsa.rag.actuals_vs_forecast_analysis","description":"High-level monthly or quarterly revenue performance by LOB and product category.","columns":[{"name":"ledger","description":"Ledger type for the record.","distinct_values":["GAAP","BUDGET","8+4","2+10","5+7"]},{"name":"metric_type","description":"Type of metric captured in amount_or_count.","sample_values":["Revenues","Adjusted Scripts","Unadjusted Scripts","COGS Post Reclass","SG&A Post Reclass","IOI","Total Membership"]},{"name":"line_of_business","description":"Business segment for the revenue record.","sample_values":["C&S","E&I","M&R","Rev Reclass","Optum","External"]},{"name":"product_category","description":"High-level product or service grouping.","sample_values":["PBM","Specialty","HDP"]},{"name":"product_sub_category_lvl_1","description":"First-level product subcategory."},{"name":"product_sub_category_lvl_2","description":"Second-level product subcategory."},{"name":"transaction_date","description":"Transaction date (yyyy-MM-dd)."},{"name":"quarter","description":"Quarter (Q1–Q4) derived from transaction_date."},{"name":"amount_or_count","description":"Value for the record (amount or count depending on metric_type)."}],"date":{"column":"transaction_date","format":"yyyy-MM-dd","default_grain":"month"},"metrics":["amount_or_count"],"group_set":{"by line of business":{"columns_used":["line_of_business"],"query_hint":["All"]},"by product category":{"columns_used":["product_sub_category_lvl_1","product_sub_category_lvl_2"],"query_hint":["top_10","bottom_10"]}},"sample_questions":["Show GAAP Revenues trend by line_of_business for the last 6 months.","Show me the top_10 product_sub_category_lvl_1,product_sub_category_lvl_2 driving the revenue","Compare GAAP vs BUDGET Revenues by line_of_business for the latest quarter and compute variance %"],"llm_instructions":{"parameters":{"recent_months":3,"baseline_months":3,"lookback_window_months":12,"min_revenue_threshold":100000,"min_percent_change_abs":0.05,"seasonality_control":"prefer month-level YoY when comparing current month to last year; else use rolling mean","date_alignment_policy":"use like-for-like windows when periods are incomplete (e.g., MTD vs prior MTD; QTD vs prior QTD)"},"comparison_modes":{"supported":["single_period","MoM","QoQ","YoY_month","YoY_quarter"],"selection_rules":["If the user specifies a single month like July 2025, run single_period at month grain.","If the user says current month vs last month, run MoM at month grain (MTD vs prior MTD if current month incomplete).","If the user says current quarter vs last quarter, run QoQ at quarter grain (QTD vs prior QTD if current quarter incomplete).","If the user says this month vs same month last year, run YoY_month with same calendar month.","If the user says this quarter vs same quarter last year, run YoY_quarter with same quarter."],"time_grain_rules":["Default to dataset.date.default_grain unless user explicitly asks for quarter or a specific month/quarter.","For quarter-level comparisons, use the dataset quarter column if available; else derive from date column."]},"ranking_policy":{"respect_query_hint":true,"single_period":{"metric":"amount_or_count","top_behavior":"Sort DESC by metric and limit N when query_hint includes top_N.","bottom_behavior":"Sort ASC by metric and limit N when query_hint includes bottom_N.","all_behavior":"Return all groups (subject to row limits) sorted DESC by metric unless user specifies otherwise."},"comparative":{"change_metrics":["pct_change","abs_change"],"top_behavior":"Sort DESC by pct_change (then abs_change) and limit N.","bottom_behavior":"Sort ASC by pct_change (then abs_change) and limit N.","baseline_filters":["Exclude chronic low performers by enforcing baseline_avg >= min_revenue_threshold."]}},"growth":{"recipe":["Aggregate SUM(amount_or_count) by the chosen group from group_set.","Resolve comparison mode per comparison_modes and construct RECENT vs BASELINE windows.","Compute recent_avg and baseline_avg over those windows.","Compute abs_change = recent_avg - baseline_avg; pct_change = abs_change / baseline_avg (guard divide-by-zero).","Apply baseline filter: baseline_avg >= min_revenue_threshold.","Apply ranking_policy according to query_hint (top/bottom/All).","Return the ranked list with recent_avg, baseline_avg, abs_change, pct_change and the time windows used."]},"decline":{"recipe":["Goal: identify segments that were strong but recently deteriorated (not persistent underperformers).","Aggregate SUM(amount_or_count) by the chosen group.","Construct RECENT vs BASELINE windows as per comparison_modes.","Compute recent_avg, baseline_avg, abs_change, pct_change.","Require baseline_avg >= min_revenue_threshold to avoid chronic laggards.","Flag as decline when pct_change <= -min_percent_change_abs.","Optionally compute moving-average trend: recent 3-month MA < prior 3-month MA to reinforce recent decline.","Apply ranking_policy bottom behavior (most negative pct_change first), respecting query_hint."]}}},{"id":"claims_drivers","name":"Revenue Drivers - Claims Detail","table":"prd_optumrx_orxfdmprdsa.rag.claim_transaction_for_pharmacy_pbm","description":"Operational revenue drivers from pharmacy claims.","columns":[{"name":"product_category","description":"Product/service channel for the claim."},{"name":"claim_status_code","description":"Claim processing status."},{"name":"line_of_business","description":"Business segment for the claim."},{"name":"carrier_id","description":"Insurance carrier identifier."},{"name":"account_id","description":"Employer/organization account identifier."},{"name":"group_id","description":"Group or subgroup under the account."},{"name":"quarter","description":"Quarter (Q1–Q4) derived from submit_date."},{"name":"submit_date","description":"Claim submission date (yyyy-MM-dd)."},{"name":"pharmacy_name","description":"Dispensing pharmacy/provider name."},{"name":"unadjusted_script_count","description":"Actual script count for each claim."},{"name":"mbr_dt_of_brth","description":"member date of birth. can be used for age level split up analysis"},{"name":"revenue_amt","description":"Revenue amount for the claim."},{"name":"drug_name","description":"Dispensed drug name."},{"name":"therapy_class_name","description":"Therapeutic class of the drug."},{"name":"brand_vs_generic_ind","description":"Brand or Generic indicator."},{"name":"DRUG_MANUFCTR_NM","description":"Drug manufacturer."},{"name":"state_cd","description":"Two-letter state code for claim/pharmacy location."},{"name":"client_id","description":"Client identifier."},{"name":"client_name","description":"Client name."}],"date":{"column":"submit_date","format":"yyyy-MM-dd","default_grain":"daily"},"metrics":["revenue_amt"],"group_set":{"by brand vs generic and drug combination":{"columns_used":["brand_vs_generic_ind","drug_name"],"query_hint":["top_10","bottom_10"]},"by therapy drug":{"columns_used":["therapy_class_name","drug_name"],"query_hint":["top_10","bottom_10"]},"by pharmacy":{"columns_used":["pharmacy_name"],"query_hint":["top_10","bottom_10"]},"by client":{"columns_used":["client_id","client_name"],"query_hint":["top_10","bottom_10"]},"by manufacturer":{"columns_used":["DRUG_MANUFCTR_NM"],"query_hint":["top_10","bottom_10"]},"by state":{"columns_used":["state_cd","drug_name"],"query_hint":["top_10","bottom_10"]},"by age group":{"columns_used":["mbr_dt_of_brth (YYYY-MM-DD)","drug_name"],"query_hint":["Age_split_up"]},"by revenue per script":{"columns_used":["unadjusted_script_count/revenue_amt"],"query_hint":["Daily,Monthly"]}},"sample_questions":["What is the revenue,script count and script per revenue analysis for particular month","Top 10 therapy class,drugs driving revenue.","Which age group people consuming the particular product which driving revenue","Compare Brand vs Generic revenue mix this month and show contribution % and rev_per_script.","Identify top 10 pharmacies by revenue in TX last quarter.","Which clients contributed the most revenue_amt in Q2? Provide top 10."],"llm_instructions":{"parameters":{"recent_months":3,"baseline_months":3,"lookback_window_months":12,"min_revenue_threshold":100000,"min_scripts_threshold":100,"min_percent_change_abs":0.05,"evaluate_rev_per_script":true,"seasonality_control":"prefer month-level YoY for current month vs same month last year; else use rolling mean","date_alignment_policy":"use like-for-like windows when periods are incomplete (MTD vs prior MTD; QTD vs prior QTD)"},"comparison_modes":{"supported":["single_period","Daily","MoM","QoQ","YoY_month","YoY_quarter"],"selection_rules":["Single explicit month (e.g., July 2025) → single_period at month grain.","Current month vs last month → MoM at month grain (MTD vs prior MTD if current month incomplete).","Current quarter vs last quarter → QoQ at quarter grain (QTD vs prior QTD if current quarter incomplete).","This month vs same month last year → YoY_month.","This quarter vs same quarter last year → YoY_quarter."],"time_grain_rules":["Default to dataset.date.default_grain unless user specifies otherwise.","Use the quarter column when quarter comparisons are requested; else derive quarter from date."]},"ranking_policy":{"respect_query_hint":true,"single_period":{"metric":"revenue_amt","top_behavior":"Sort DESC by metric and limit N when query_hint includes top_N.","bottom_behavior":"Sort ASC by metric and limit N when query_hint includes bottom_N.","all_behavior":"Return all groups (subject to row limits) sorted DESC by metric unless user specifies otherwise."},"comparative":{"change_metrics":["pct_change","abs_change","delta_rev_per_script"],"top_behavior":"Sort DESC by pct_change (then abs_change) and limit N.","bottom_behavior":"Sort ASC by pct_change (then abs_change) and limit N.","baseline_filters":["Exclude chronic low performers: baseline_avg >= min_revenue_threshold and baseline_scripts >= min_scripts_threshold when available."]}},"growth":{"recipe":["Aggregate SUM(revenue_amt) and SUM(unadjusted_script_count) by the chosen group.","Resolve comparison mode per comparison_modes and build RECENT vs BASELINE windows.","Compute recent_avg and baseline_avg for revenue (and scripts if evaluating rev_per_script).","Compute abs_change and pct_change; if evaluate_rev_per_script=true, compute delta_rev_per_script = recent_avg/recent_scripts - baseline_avg/baseline_scripts.","Apply baseline filters: baseline_avg >= min_revenue_threshold and, when relevant, baseline_scripts >= min_scripts_threshold.","Apply ranking_policy in line with query_hint (top/bottom/All).","Return ranked groups with recent_avg, baseline_avg, abs_change, pct_change and delta_rev_per_script (if applicable)."]},"decline":{"recipe":["Objective: find entities that were previously strong but have recently declined.","Aggregate SUM(revenue_amt) and SUM(unadjusted_script_count) by group.","Construct RECENT vs BASELINE windows as per comparison_modes.","Compute recent_avg, baseline_avg, abs_change, pct_change and delta_rev_per_script (if scripts available).","Require baseline strength: baseline_avg >= min_revenue_threshold and baseline_scripts >= min_scripts_threshold (if available).","Flag decline where pct_change <= -min_percent_change_abs and/or delta_rev_per_script < 0 when evaluating margin/mix effects.","Optional robustness: recent 3-month MA < prior 3-month MA to emphasize recent deterioration.","Apply ranking_policy bottom behavior, honoring query_hint (e.g., bottom_10 = most negative pct_change among valid baselines)."]}}}]}}

Dataset prd_optumrx_orxfdmprdsa.rag.claim_transaction_for_pharmacy_pbm. Claim-level transactions with submit_date, claim identifiers and status, plus client/carrier/account/group, pharmacy, and drug attributes. Suitable for utilization and financial analyses including revenue/expense/WAC/AWP, revenue per script, and GDR. Metrics: revenue, expense, wac, awp, unadjusted_scripts, adjusted_scripts, 30_day_scripts, 90_day_scripts, revenue_per_script, gdr. Attributes: product_category, claim_nbr, claim_seq_nbr, claim_status_code, line_of_business, line_of_business_desc, carrier_id, account_id, group_id, client_id, client_name, pharmacy_name, pharmacy_npi_no, drug_name, therapy_class_name, brand_vs_generic_ind, gpi_no, ndc_code, DRUG_MANUFCTR_NM, state_code, client_type, submit_date, year, month, quarter,member date of birth and sex',
'{"table_name":"prd_optumrx_orxfdmprdsa.rag.claim_transaction_for_pharmacy_pbm","Table levl description":"Claim-level dataset with identifiers, submit dates, claim status, client/carrier/account/group, pharmacy, and drug attributes and variance analysis at drug, therapy class, manufacturer, and other attributes level. Supports utilization and financial analyses (revenue/expense/WAC/AWP), plus derived metrics like revenue per script and GDR.","columns":[{"column_name":"product_category","description":"Indicates the category of product or service for each claim. Distinct values: PBM, Home Delivery (HDP), and Specialty (SP)","distinct_values":["PBM","Home Delivery","Specialty"]},{"column_name":"claim_nbr","description":"Contains unique claim numbers used to identify individual claims in the dataset. Do not use for any calculation; use unadjusted script count for claim counts"},{"column_name":"claim_seq_nbr","description":"Sequence of transactions within the same claim_nbr (e.g., original, reversal). Not used for aggregations or script counts."},{"column_name":"claim_status_code","description":"Processing status of the claim. For utilization/financial metrics use P (Paid)and X (Reveresed). Paid and reversed together reflect net activity.Always Include P,X for derivation.","distinct_values":["P","X"]},{"column_name":"line_of_business","description":"Contains line of business (LOB) identifier and is distinct from client type.","distinct_values":["E&I FI","E&I ASO","C&S","PDP","MAPD","E&I UMR","External"]},{"column_name":"line_of_business_desc","description":"Contains detailed descriptive name of the line of business","distinct_values":["Employer & Individual - United Medical Resources","Medicare Advantage Prescription Drug","Prescription Drug Plan","Others","Community & State","Employer & Individual - Fully Insured","Employer & Individual - Administrative Services Only","External"]},{"column_name":"carrier_id","description":"Identifier of the insurance carrier administering the plan."},{"column_name":"account_id","description":"Client or employer account identifier under which the policy is issued."},{"column_name":"group_id","description":"Group/subgroup within the account; used for sub-client analysis."},{"column_name":"year","description":"Calendar year of claim submission; supports YoY comparisons."},{"column_name":"month","description":"Calendar month of submission; it has numerical value (1-12)."},{"column_name":"quarter","description":"Calendar quarter; supports quarter-over-quarter analysis.contains Q1,Q2,Q3,Q4"},{"column_name":"submit_date","description":"Exact claim submission date. Use for daily trending and time-window filters."},{"column_name":"pharmacy_name","description":"Dispensing pharmacy/provider name; used for provider-level performance."},{"column_name":"pharmacy_npi_no","description":"National Provider Identifier (NPI) of the dispensing pharmacy/provider."},{"column_name":"unadjusted_script_count","description":"Raw script/claim count per event. Use for total volume and as the denominator for revenue_per_script."},{"column_name":"90_days_script_count","description":"Count of 90-day prescriptions; useful for mail-order and adherence analyses."},{"column_name":"30_days_script_count","description":"Count of 30-day prescriptions; complements 90-day for supply-mix insights."},{"column_name":"adjusted_script_count","description":"adjusted script count and should not be used for raw script count or revenue per script analysis."},{"column_name":"revenue_amt","description":"Revenue recognized for the claim. Use with unadjusted_script_count to derive revenue_per_script."},{"column_name":"expense_amt","description":"Expense/cost of goods sold for the claim. Pairs with revenue_amt for margin views."},{"column_name":"wac_amount","description":"Wholesale Acquisition Cost reference for the dispensed drug; used in pricing/cost analytics."},{"column_name":"awp_cost_amount","description":"Average Wholesale Price reference for the dispensed drug; used in pricing/cost analytics."},{"column_name":"client_id","description":"This contain unique client id."},{"column_name":"client_name","description":"This contains client description. Return alongside client_id for user-facing reports."},{"column_name":"drug_name","description":"Name of the dispensed drug; use for molecule-level trends and financials."},{"column_name":"therapy_class_name","description":"Therapeutic class of the drug. Choose class or specific drug based on the question. sample therapy class names are Oncology,GLP-1 Receptor Agonists,SGLT-2 Inhibitors & Combos,GLP-1 Anti-Obesity Agents.if the user is asking generically GLP-1 then use like operator to get all the GLP-1 related information"},{"column_name":"brand_vs_generic_ind","description":"Product type indicator. Drives brand/generic mix and Generic Dispense Rate","distinct_values":["Brand","Generic"]},{"column_name":"gpi_no","description":"Generic Product Identifier; standardized drug classification used for grouping."},{"column_name":"revenue_per_script","description":"Derived metric: revenue_amt ÷ unadjusted_script_count. Used for pricing/margin insights and mix effects."},{"column_name":"GDR_Ratio","description":"Derived Metric:Calculates the percentage of generic drug scripts by dividing the count of scripts where BVSG =Generic by the total script volume"},{"column_name":"ndc_code","description":"National Drug Code identifier for the dispensed product."},{"column_name":"DRUG_MANUFCTR_NM","description":"Drug manufacturer; supports brand/manufacturer market-share views."},{"column_name":"state_cd","description":"Two-letter state code where the claim was processed or pharmacy located; used for geographic analysis."},{"column_name":"mbr_dt_of_brth","description":"Contains member date of birth in the format YYYY-MM-DD, enabling age-based segmentation and analysis"},{"column_name":"mbr_sex","description":"Contains values M or F representing Male or Female respectively, and is suitable for sex-level demographic or behavioral analysis."},{"column_name":"client_type","description":"it used identify the type of the client","distinct_values":["SECONDARY,PHARM TECH,MS UHCMB,WORK COMP,GOVERNMENT,HOSPISCRIPT,PUBLIC SECTOR COMPANIES,STRATEGIC SOLUTIONS,PAYER,WRAP,DIRECT EMPLOYER,MS WC,HEALTH PLAN,PROVIDER,REBATES,MCO,MS ONLY,MAPD,COE,TPA CLIENTS,OTHER,UMR,LABOR TRUST,FMS ONLY,EMPLOYER CARVE OUT,DISCOUNT CARD"]},{"column_name":"pharmacy_type","description":"Used to identify the pharmacy type whether optum owned internal or external pharmacies","distinct_values":["EXTERNAL-NON OPTUM OWNED,INTERNAL OPTUM OWNED"]}]}',
'{"table_name":"prd_optumrx_orxfdmprdsa.rag.claim_transaction_for_pharmacy_pbm","description":"Claim-level dataset supporting financial and utilization analysis across client, pharmacy, and drug dimensions. Enables variance tracking by therapy class, manufacturer, and other attributes, with daily granularity and derived metrics like revenue per script and GDR.","useful_for":["claim-level financial analysis","client-level analysis","drug and therapy class performance","manufacturer-level insights","revenue per script and GDR metrics","line-of-business tracking","daily and monthly trend analysis","rate analysis"],"not_useful_for":["budget-level summaries","forecast comparisons","aggregated financial reporting without claim-level detail"],"metrics":["revenue","expense","cogs","wac","awp","unadjusted_scripts","adjusted_scripts","30_day_scripts","90_day_scripts","revenue_per_script","gdr","volume"],"attributes":{"claim_nbr":"string","submit_date":"date","client_id":"string","pharmacy_npi_no":"string","drug_name":"string","therapy_class_name":"string","drug_manufctr_nm":"string","line_of_business":"string","state_cd":"string","brand_vs_generic":"string","client_type":"string","gpi_no":"string","pharmacy_name":"string","pharmacy_type":"string","carrier_id":"string","member_date_of_birth":"date","member_sex":"string"},"time_grains":["daily","monthly","quarterly","yearly"]}
