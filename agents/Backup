
search_metadata_sql(['External'])
üîç Starting single-query cascading search for filters: ['External']
üìä Single Query (All Tiers): 
        WITH matched_data AS (
            SELECT
                column_name,
                trim(exploded_value) AS individual_value,
                
            CASE 
                WHEN lower(trim(exploded_value)) = 'external' THEN 1
                WHEN lower(trim(exploded_value)) RLIKE '^external\\b' THEN 2
                ELSE 3
            END
         AS match_tier
            FROM prd_optumrx_orxfdmprdsa.rag.distinct_values_metadata1
            LATERAL VIEW explode(split(distinct_values, ',')) AS exploded_value
            WHERE (lower(trim(exploded_value)) = 'external') OR (lower(trim(exploded_value)) RLIKE '^external\\b') OR (lower(trim(exploded_value)) RLIKE '(?i)\\bexternal')
        ),
        scored_aggregated AS (
            SELECT
                column_name,
                collect_list(individual_value) AS all_matched_values,
                MIN(match_tier) AS best_tier  -- Get the best (lowest) tier for each column
            FROM matched_data
            GROUP BY column_name
        )
        SELECT
            column_name,
            concat_ws(', ', slice(all_matched_values, 1, 5)) AS matched_values,
            best_tier
        FROM scored_aggregated
        ORDER BY best_tier ASC, column_name
        
results_data_filter DataFrame[column_name: string, matched_values: string, best_tier: int]
‚ùå No matches found
[]
