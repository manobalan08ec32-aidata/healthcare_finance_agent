"prd_optumrx_orxfdmprdsa.rag.pbm_claims": {
        "table_name": "prd_optumrx_orxfdmprdsa.rag.pbm_claims",
        "playbook": {
            "recommended_investigation_flow": {
                "description": "When pivoting from ledger to claims, follow this progressive drill-down sequence to systematically identify drivers",
                "sequence": "client_name → carrier_id → therapy_class_name → drug detail → brand_vs_generic_ind → claim_status_code → member demographics",
                "level_1_client": "Start with client_name to identify which customers driving variance. Show top 10 clients by delta revenue/scripts. Calculate rate_variance, volume_variance, mix_variance by client. Assess concentration - do top 5-10 clients account for >70% of variance?",
                "level_2_carrier": "If client-level shows concentration, examine carrier_id patterns. Check if multiple high-variance clients belong to same carrier indicating carrier-level dynamics rather than individual client issues.",
                "level_3_therapy_class": "Investigate therapy_class_name to understand drug category drivers. List therapies by revenue contribution, delta revenue, delta rate. Identify if specialty categories (Oncology, GLP-1) driving variance.",
                "level_4_drug_detail": "For high-impact therapy classes, drill into specific drug detail within those therapy categories. Show top drugs by volume and revenue within the therapy class. Examine pricing trends (wac_amount, awp_cost_amount) for specific drugs.",
                "level_5_brand_generic": "Check brand_vs_generic_ind mix impact. Calculate GDR_Ratio (Generic Dispense Rate) trend. Show if brand penetration increasing (GDR declining) which drives rate up and cost up. Quantify brand vs generic revenue and cost contribution.",
                "level_6_claim_status": "Verify claim_status_code patterns to rule out operational issues. Calculate reversal rate (X / P ratio). Check if reversal patterns unusual for specific clients or therapies. Ensure using P and X together for net activity analysis.",
                "level_7_demographics": "If variance not explained by above levels, examine member demographics. Show mbr_sex distribution for gender patterns. Calculate age cohorts from mbr_dt_of_brth for age-based utilization. Useful for therapies with demographic skew.",
                "flexibility_note": "This sequence provides a systematic framework but can be adapted based on context. If ledger already identified product-level pattern, may start at therapy_class level. If client already scoped in question, start at therapy or brand/generic level. Use judgment to skip levels when appropriate."
            },
            "core_principles": "Stay in claims and deepen drivers using available dimensions. Use top/bottom N analysis to surface concentrated drivers. Provide daily/monthly trend when it clarifies the story. Preserve any scope from prior queries (time period, LOB, product, client). Focus on WHAT-type observable facts, not why/because questions. Prefer executable verbs: Show/Break/Decompose/List/Compare.",
            "revenue_analysis": "When revenue_amt moves, first check volume by showing unadjusted_script_count trend for the same period - compare current vs prior period script volume using unadjusted_script_count as primary volume metric. Then check rate by calculating revenue_per_script (revenue_amt / unadjusted_script_count) trend and comparing current vs prior period. Decompose into rate_variance, volume_variance, mix_variance to identify which component is largest - calculate at client_name or therapy_class_name level. If rate_variance dominates: check brand_vs_generic_ind mix shift (did GDR change), show revenue_per_script by therapy_class_name, list client_name with largest rate changes, compare pharmacy_type rate differences (Internal vs External). If volume_variance dominates: show unadjusted_script_count by client_name, break down by therapy_class_name volume trends, check line_of_business or client_type volume patterns, show state_cd geographic distribution. If mix_variance dominates: calculate GDR_Ratio trend (Generic Dispense Rate change), show therapy_class_name mix change (high-revenue vs low-revenue therapies), compare client mix shift (high-rate vs low-rate clients), check if specialty therapy penetration changing. Finally perform concentration analysis: list top 10 therapy_class_name by revenue contribution, show top 10 client_name driving the variance, calculate if top 5 entities account for >70% of change (Pareto principle), identify concentrated drivers for potential escalation.",
            "cost_analysis": "When expense_amt moves, start with pricing pressure check by showing wac_amount (Wholesale Acquisition Cost) trend and awp_cost_amount (Average Wholesale Price) trend over time, then calculate average cost per script (expense_amt / unadjusted_script_count) trend. Check brand vs generic mix by examining brand_vs_generic_ind distribution change, calculate GDR_Ratio trend (lower GDR means more brand which means higher cost), show cost per script difference between Brand and Generic. Analyze therapy class cost impact by listing therapy_class_name by average expense_amt per script, showing volume growth in high-cost therapy classes (Oncology, GLP-1, Specialty), calculating therapy mix impact on overall cost per script. Compare channel/pharmacy cost by showing expense_amt per script by pharmacy_type (Internal Optum Owned vs External), checking if external pharmacy volume shifting (typically higher cost), examining product hierarchy cost patterns via line_of_business_desc. Investigate client/contract cost patterns by showing expense_amt per script by client_type or client_name, identifying clients with largest cost per script increases, checking if specific contract types have different cost structures.",
            "script_volume_analysis": "When unadjusted_script_count declines or grows unexpectedly, first check supply days mix by comparing 30_days_script_count vs 90_days_script_count trends and calculating 90-day script percentage trend - note that shift to 90-day reduces script count but may be volume-neutral from days supply perspective. Check adjustment factor by comparing adjusted_script_count vs unadjusted_script_count to rule out data methodology changes (usually minor). Perform claim status/quality check by examining claim_status_code distribution (P=Paid vs X=Reversed), calculating reversal rate trend to see if increasing, showing daily unadjusted_script_count pattern for anomalies, filtering to P and X only for net utilization analysis. Break down by business segment by showing unadjusted_script_count by line_of_business, client_type, or client_name, listing top/bottom clients by volume change. Analyze therapy and geographic patterns by showing therapy_class_name volume trends, checking brand_vs_generic_ind volume distribution, breaking down by state_cd for geographic patterns, showing pharmacy_type volume mix (Internal vs External).",
            "client_deep_dive": "When analyzing specific client or client_type patterns, show client revenue_amt and unadjusted_script_count trends, calculate revenue_per_script for the client, compare client metrics vs overall average. Calculate rate_variance, volume_variance, mix_variance for the client to identify which component driving their performance, compare client variance pattern to overall pattern. Show client's therapy_class_name distribution, calculate client's GDR_Ratio (generic rate), compare client's brand_vs_generic_ind mix to overall average. If variance concentrated in one client, break down by account_id or group_id, use CAG (carrier_id + account_id + group_id concatenation) for benefit design analysis, identify if specific subgroups driving client variance. Show client's pharmacy_type utilization pattern (Internal vs External preference), examine client's geographic distribution via state_cd if relevant, check client's line_of_business_desc for business context.",
            "therapy_and_drug_deep_dive": "List therapy_class_name ranked by revenue contribution, script volume (unadjusted_script_count), and revenue_per_script to understand drug category portfolio. Show therapy classes with largest delta revenue, delta scripts, and delta rate between periods to identify growth/decline drivers. For high-impact therapies, break down by brand_vs_generic_ind to understand if brand or generic driving the therapy's performance. Check if specialty therapies (Oncology, Infusion, GLP-1 categories) growing faster than overall portfolio - filter therapy_class_name LIKE '%GLP-1%' for focused analysis on rapidly growing weight-loss and diabetes drug category. Show therapy_class_name by pharmacy_type to understand if certain therapies dispensed more through Internal vs External channels. For therapies with unusual patterns, examine wac_amount and awp_cost_amount trends to see if drug pricing changed. Show top clients for high-impact therapies to understand client concentration. Calculate therapy mix percentage changes between periods to quantify portfolio shift.",
            "variance_decomposition_deep_dive": "Calculate rate_variance as (Prior Period Average Rate - Current Period Average Rate) × Current Period Volume, where rate is revenue_per_script calculated as revenue_amt / unadjusted_script_count. Calculate volume_variance as (Prior Period Volume - Current Period Volume) × Current Period Average Rate, where volume is unadjusted_script_count. Calculate mix_variance as (Prior Period Revenue - Current Period Revenue - Rate Variance - Volume Variance). Perform decomposition at granular levels: by client_name to identify which clients contributing most to each variance component, by therapy_class_name to understand drug category impact, by pharmacy_type to see channel effects, by state_cd for geographic attribution. When rate_variance dominates (>50% of total variance): focus follow-ups on brand_vs_generic_ind mix shifts, therapy_class_name rate changes, client-specific rate movements, pharmacy_type rate differences. When volume_variance dominates: focus on client volume losses/gains, therapy volume trends, line_of_business shifts, claim_status_code quality issues. When mix_variance dominates: focus on GDR shifts (generic dispense rate changes), therapy class redistribution (high-cost vs low-cost therapy mix), client mix changes (high-rate vs low-rate client mix), product hierarchy shifts.",
            "channel_and_pharmacy_deep_dive": "Compare pharmacy_type (Internal Optum Owned vs External Non-Optum Owned) across all key metrics: revenue_amt, unadjusted_script_count, revenue_per_script, expense_amt per script, brand_vs_generic_ind mix. Calculate internal capture rate as (Internal pharmacy scripts / Total scripts) trend to understand channel mix shift over time. Show if external pharmacy volume growing which typically indicates lower capture and different margin/cost profile. Break down internal vs external patterns by line_of_business to see if specific LOBs have different pharmacy type preferences or contractual requirements. For internal pharmacy specifically, examine member loyalty patterns and therapy_class_name mix to understand specialty capture. Compare brand_vs_generic_ind (GDR) between Internal vs External to see if generic substitution rates differ by channel - internal may have higher generic rate. Show cost structure differences by calculating expense_amt per script for Internal vs External across different therapy classes.",
            "geographic_and_demographic_deep_dive": "Show state_cd breakdown for revenue_amt, unadjusted_script_count, and revenue_per_script trends to identify geographic concentration or regional patterns. Compare top states by delta revenue or delta scripts to find regional drivers of overall variance. For high-impact states, drill into client_name distribution to understand if state pattern driven by client mix (large client in that state) or broader regional trends (market dynamics). Show state_cd by therapy_class_name to understand regional drug utilization differences. When relevant for therapy or demographic analysis, examine mbr_sex distribution to understand gender differences in utilization or therapy mix - some therapies (e.g., women's health, men's health) have gender skew. Calculate age cohorts using mbr_dt_of_brth by converting birth date to age (current year minus birth year) and grouping into cohorts like 18-34, 35-49, 50-64, 65+ to understand age-based patterns. Examine therapy_class_name distribution by age cohorts to understand different drug category usage - older cohorts typically higher utilization of chronic disease therapies.",
            "operational_and_quality_checks": "Always verify claim_status_code distribution focusing on P (Paid) and X (Reversed) for net activity since both together reflect true utilization and financial impact - never analyze P alone without considering X. Calculate reversal rate trend as (X count / P count) or (X count / total claims) to monitor operational quality - sudden spikes in reversal rate may indicate system issues, policy changes, or operational problems requiring investigation. Show daily transaction count pattern using submit_date to verify data completeness across the analysis period - missing days or sudden drops in daily counts require investigation before drawing conclusions. For outlier clients or unusual time periods, examine claim_nbr distinct count vs unadjusted_script_count sum to ensure data integrity and understand if claims mapping correctly. Check if specific client_type or line_of_business has unusual reversal patterns that might indicate contractual or operational issues. When volume patterns seem unusual or unexpected, verify that time periods being compared have same number of business days to ensure fair comparison. For any analysis involving expense_amt or revenue_amt, ensure claim_status_code filtered appropriately since reversed claims may have negative amounts.",
            "pattern_recognition_and_signals": "When rate increases but volume decreases (revenue may be flat or slightly down): check daily unadjusted_script_count trend as membership/utilization proxy to understand if losing members or scripts per member declining, show brand_vs_generic_ind mix shift since increasing brand mix raises revenue_per_script, calculate GDR_Ratio trend to quantify generic rate change, decompose rate_variance vs volume_variance by client_name and therapy_class_name to identify if concentrated in specific entities or broad-based. When both rate and volume decline (revenue significantly down): focus on top/bottom clients by delta revenue to find if decline concentrated or dispersed, show brand_vs_generic_ind shift (GDR change) to rule out mix impact, list therapy_class_name with largest combined rate and volume impact to identify drug category drivers, check if specific client_type or line_of_business driving both declines which would indicate segment-level issue. When volume declines but rate stable (revenue down proportional to volume): check 30_days_script_count vs 90_days_script_count mix shift since supply days change affects script count but not revenue proportionally, show client_name volume changes for concentration analysis, verify claim_status_code reversal rate not increasing which would indicate data quality vs true volume decline, analyze therapy_class_name volume trends to see if specific drug categories declining, check state_cd geographic patterns for regional concentration. When cost increases (expense_amt or expense per script rising): investigate wac_amount and awp_cost_amount pricing trends to identify manufacturer price increases, check GDR_Ratio decline (more brand dispensing) since brand drugs significantly more expensive, show high-cost therapy_class_name volume growth since specialty drug volume growth increases overall cost, compare pharmacy_type cost differences since external typically higher cost structure.",
            "pareto_and_concentration_tactics": "Apply top/bottom N analysis to identify concentrated drivers and focus follow-up investigations: show top 10 clients by revenue contribution and by delta revenue, list top 10 therapy_class_name by script volume and by delta scripts, identify top 5-10 states if geographic concentration exists. Calculate concentration metrics to determine if variance is concentrated or dispersed: do top 5 clients account for >70% of total variance, do top 3 therapy classes represent >60% of volume change, is top state >30% of geographic impact. When high concentration found (few entities drive majority of variance): drill deeper into those specific entities with detailed analysis - for concentrated clients examine their therapy mix, brand/generic mix (GDR), pharmacy type usage, account_id/group_id breakdown (CAG); for concentrated therapies show their client distribution, brand/generic split, pricing trends (wac_amount, awp_cost_amount), pharmacy channel preference. If concentration is low (variance dispersed across many entities with no clear top drivers): consider suggesting re-anchor to ledger to look at systematic segment-level patterns rather than continuing granular entity analysis which may not yield actionable insights - dispersed patterns often indicate broad market or segment trends better analyzed at ledger level.",
            "optional_analytical_angles": "Consider channel splits by comparing pharmacy_type Internal Optum Owned vs External Non-Optum Owned across all key metrics (revenue, scripts, rate, cost) to understand capture and margin implications. Focus on GLP-1 drugs by filtering therapy_class_name LIKE '%GLP-1%' or '%GLP1%' given rapid growth in weight-loss and diabetes medication categories with high revenue and cost impact. Perform Pareto analysis showing top N entities (clients, therapies, states) contributing X% of total or variance to identify concentration and focus. Analyze day-of-week patterns using submit_date day-of-week to check for weekly seasonality, operational patterns like batch processing, or day-specific anomalies. Conduct outlier detection to identify clients, therapies, or states with statistical outlier rate or volume changes requiring investigation - calculate z-scores or flag entities >2 standard deviations from mean. Show geographic breakdown by state_cd when regional patterns relevant for utilization, cost, or revenue analysis. Examine demographic patterns using mbr_sex for gender-specific therapy analysis and age cohorts from mbr_dt_of_brth for age-based utilization patterns. Compare specific high-impact therapy classes like Oncology, GLP-1, Specialty injectables, Immunology that have unique cost profiles and utilization patterns requiring focused analysis.",
            "re_anchor_to_ledger_conditions": "After claims analysis identifies concentrated drivers or specific patterns, suggest re-anchoring to ledger to verify findings roll up correctly and to add financial context not available in claims. When claims shows fewer than 5 clients drive more than 80% of variance (highly concentrated): suggest checking ledger metric_type='Revenues' and 'Gross Profit Post Reclass' for those clients' line_of_business to understand if margin impacted beyond revenue and what the ledger-level financial impact is. When specific therapy classes or drug categories identified as key drivers in claims: verify they align with ledger product_category (Specialty vs PBM vs Home Delivery) or product_sub_category_lvl_1 variance to ensure consistent story across tables. When claims deep-dive investigation complete with clear drivers identified: propose verifying the findings explain the original ledger variance that prompted the claims investigation - frame as 'Verify these claims drivers roll up to the ledger variance we started with' or 'Check ledger-level margin and operating metrics impact for the identified claim drivers'. When client or therapy concentration is high: suggest checking ledger for same LOB/product at monthly level to see if pattern persistent or one-time, and to understand margin implications. Do not imply join between tables - always frame as validation that complementary views tell consistent story about the business for the same conceptual scope and time period."
        },
        "dimensions": [
           
            {
                "field_name": "client_id",
                "description": "Unique client identifier."
            },
            {
                "field_name": "client_name",
                "description": "Client description for user-facing reports."
            },
            {
                "field_name": "client_type",
                "description": "Type of the client.",
                "sample_values": [
                    "SECONDARY",
                    "PHARM TECH",
                    "MS UHCMB"
                ]
            },
			
			{
                "field_name": "drug_name",
                "description": "contains drug information."
            },
			{
                "field_name": "therapy_class_name",
                "description": "Therapeutic class of the drug."
            },
            {
                "field_name": "brand_vs_generic_ind",
                "description": "Product type indicator for brand/generic analysis.",
                "distinct_values": [
                    "Brand",
                    "Generic"
                ]
            },
            {
                "field_name": "carrier_id",
                "description": "Identifier of the insurance carrier administering the plan."
            },
            {
                "field_name": "account_id",
                "description": "Client or employer account identifier."
            },
            {
                "field_name": "group_id",
                "description": "Group/subgroup within the account for sub-client analysis."
            },
			 {
                "field_name": "state_cd",
                "description": "Two-letter state code for geographic analysis.",
                "distinct_values": [
                    "TX",
                    "CA",
                    "MN"
                ]
            },
            {
                "field_name": "line_of_business",
                "description": "Line of business identifier.",
                "distinct_values": [
                    "E&I FI",
                    "E&I ASO",
                    "C&S",
                    "PDP",
                    "MAPD",
                    "E&I UMR",
                    "External"
                ]
            },
            
            {
                "field_name": "pharmacy_type",
                "description": "Identifies pharmacy type - internal or external.",
                "distinct_values": [
                    "INTERNAL OPTUM OWNED",
                    "EXTERNAL-NON OPTUM OWNED"
                ]
            },
            
            {
                "field_name": "mbr_dt_of_brth",
                "description": "Member date of birth enabling age-based segmentation.",
                "format": "YYYY-MM-DD"
            }
        ],
        "metrics": [
            {
                "field_name": "revenue_amt",
                "description": "Revenue recognized for the claim. Use with unadjusted_script_count to derive revenue_per_script."
            },
            {
                "field_name": "expense_amt",
                "description": "Expense/cost of goods sold for the claim. Pairs with revenue_amt for margin views."
            },
        
            {
                "field_name": "unadjusted_script_count",
                "description": "Raw script/claim count per event. Use for total volume and as denominator for revenue_per_script."
            },
          
            {
                "field_name": "revenue_per_script",
                "description": "Derived metric: revenue_amt / unadjusted_script_count",
                "is_derived": true
            },
            {
                "field_name": "rate_variance",
                "description": "contain rate variance formula",
                "is_derived": true
            },
            {
                "field_name": "volume_variance",
                "description": "contains volume variance formula",
                "is_derived": true
            },
            {
                "field_name": "mix_variance",
                "description": "Derived metric: Prior Period Revenue - Current Period Revenue - Rate Variance - Volume Variance",
                "is_derived": true
            },
            {
                "field_name": "GDR_Ratio",
                "description": "Derived metric: Generic Dispense Rate - percentage of generic scripts (count where brand_vs_generic_ind='Generic' / total scripts)",
                "is_derived": true
            }
        ]
    }

followup_prompt = f"""
               You are generating intelligent follow-up questions for healthcare finance analysis to help users drill down deeper into their data.

            CURRENT CONTEXT:
            Current Question: "{current_question}"

            Last 3 questions summary: "{narrative_response_hist}"

            USER QUESTION HISTORY (Last 15):
            {recent_user_questions}

            DOMAIN SELECTION CONTEXT: {domain_selection}
            
            PRODUCT CATEGORY FILTERING RULES:
            - If domain selection contains "PBM Network": Only suggest PBM-related product categories in follow-up questions
            - If domain selection contains "Optum Pharmacy": Only suggest Home Delivery (HDP) and/or Specialty (SP) product categories in follow-up questions
            - Never suggest product categories that don't align with the user's domain selection
            - When suggesting breakdowns by product category, respect these domain boundaries

            DATASET METADATA:
            {metadata}

            ==============================
            CRITICAL RULES - FOLLOW EXACTLY
            ==============================

            # Question Generation Requirements

            ## Format
            - Use action verbs: "Show", "What", "Break down", "Compare", "List", "Calculate"
            - Be specific and executable - NOT vague like "dig deeper" or "analyze further"
            - Each question should be a clear, runnable query

            ## Natural Language for Metrics
            - Use functional/business names instead of exact technical metric names
            - Examples:
            - Instead of "revenue_amt", use "revenue"
            - Instead of "expense_amt", use "cost" or "expenses"
            - Instead of "revenue_per_script", use "revenue per script" or "rate"
            - Instead of "brand_vs_generic_ind", use "brand vs generic"
            - Questions should still be interpretable for SQL generation - use clear business terminology that maps to the underlying metrics

            ## Time Period Preservation
            - Carefully read `last_user_question` to identify the time period being analyzed (e.g., "Q3 2024", "last two months", "September 2024", "YTD")
            - Maintain the SAME time period context in all follow-up questions unless there's a specific reason to change it (like YoY comparison)
            - Examples:
            - If user asked about "Q3 2024", follow-ups should reference "Q3 2024"
            - If user asked about "last two months", follow-ups should reference "last two months" or the specific months
            - If user asked about "September 2024", follow-ups should reference "September 2024"
            - When suggesting time comparisons (YoY, MoM, QoQ), make the comparison explicit: "Compare Q3 2024 vs Q3 2023" or "Show September 2024 vs August 2024"

            ## Investigation Flow
            - Read the `playbook` from `table_context` to understand recommended investigation sequences
            - Follow the `investigation_flow`, `investigation_priority`, or `recommended_investigation_flow` if present
            - Apply `pattern_recognition` or `pattern_signals` guidance based on patterns detected in `last_query_answer`
            - Progress through the investigation logically (don't jump levels randomly)

            ## Context Awareness
            - Analyze `last_query_answer` to understand:
            - What was discovered (patterns, concentration, variance drivers)
            - What metrics moved and how (rate up/down, volume up/down, etc.)
            - Whether results show concentration (top N = X%) or dispersed patterns
            - Use the playbook's analysis sections (revenue_analysis, cost_analysis, volume_analysis, etc.) as guidance
            - Adapt questions based on what the user is investigating (their focus area from history)

            ## Reference Strategy for Follow-up Questions
            
            **Use Specific Names (ONLY when extractable with clear attribute context)**:
            - Extract actual values from narrative history ONLY if they include the attribute name (column context)
              - **GOOD**: "Break down the revenue per script for Client MDOVA in July 2025" (narrative mentions "Client MDOVA" - clear column context)
              - **GOOD**: "What is the performance for Drug MOUNJARO and ELIQUIS in July 2025?" (narrative mentions "Drug MOUNJARO" - clear column context)
              - **BAD**: "Show me more about MDOVA" (narrative only mentions "MDOVA" without "Client" - unclear which column)
              - **CRITICAL**: If narrative only contains raw values (like "MDOVA", "Commercial") without attribute prefixes (like "Client MDOVA", "Line of Business Commercial"), DO NOT use them in follow-up questions

            **COLUMN MAPPING REQUIREMENTS**:
            - Always reference metadata to ensure column names exist: drug_name, client_name, therapy_class_name, line_of_business, etc.
            - Use business-friendly terms that map to actual columns: "drugs" → drug_name, "clients" → client_name, "therapy classes" → therapy_class_name
            - Include appropriate filter context: "for [metric] in [timeframe]" or "by [dimension] for [timeframe]"
            
            **STRICT AVOIDANCE RULES**:
            - Vague references: "these top 10 drugs", "those clients", "the previous results"  
            - Unmappable terms: Don't suggest dimensions/metrics not available in metadata
            - Context-dependent references that require memory of specific previous query results
            - **Isolated values without attribute context**: If narrative says "MDOVA has high revenue" instead of "Client MDOVA has high revenue", don't reference MDOVA in follow-ups
            - **Ambiguous values**: If you cannot determine which column a value belongs to, exclude it from follow-up questions

            ## Leverage Available Fields
            - Reference `dimensions` from meta data to suggest valid grouping/filtering options
            - Reference `metrics` from meta data to suggest valid measures and derived calculations
            - Use business-friendly dimension names where appropriate (e.g., "client" instead of "client_name", "therapy class" instead of "therapy_class_name", "line of business" instead of "line_of_business")
            - Questions should be natural but still map clearly to the available dimensions and metrics

            ## Constraints
            - Check `questions_history` - do NOT suggest questions that have already been asked, answered, or are semantically similar
            - Preserve scope: maintain time periods, filters, and dimensional focus from `last_user_question`
            - Use "top 20" or "bottom 20" for ranking questions (not top 5 or top 10)
            - If playbook suggests pivoting to complementary table, frame the question for that table's context
            - **DOMAIN-SPECIFIC PRODUCT CATEGORY FILTERING**:
              - If domain = "PBM Network": ONLY suggest PBM-related categories, NEVER Home Delivery or Specialty
              - If domain = "Optum Pharmacy": ONLY suggest Home Delivery and/or Specialty categories, NEVER PBM
              - When suggesting "break down by product category" or similar, respect domain boundaries
              - Example: For PBM Network users, suggest "Break down by PBM product category" not "Break down by Home Delivery and Specialty"

            ## Quality Standards
            - Questions should advance the investigation, not just restate what was asked
            - Suggest the "next logical step" based on investigation flow and what was discovered
            - If concentration found (top few entities = high %), drill into those entities
            - If dispersed pattern found, suggest segment-level or aggregated views
            - Balance between staying in current analysis depth vs advancing to next level
            - Ensure questions are business-friendly and natural-sounding while remaining precise enough for SQL generation

            ==============================
            RESPONSE FORMAT
            ==============================
            -Generate only 3 follow up questions strictly
            The response MUST be valid JSON. Do NOT include any extra text, markdown, or formatting. The response MUST not start with ```json and end with ```.

            {{
            "followup_questions": ["What is the [metric] by [attribute] for [context]?", "Break down is the [metric] by [attribute] for [context]?", "show me the [metric] by [attribute] for [context]?"]
            }}

        """
