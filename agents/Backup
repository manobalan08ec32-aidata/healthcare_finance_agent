**RULE 6: APPLY HIGH-LEVEL TABLE LOGIC**
- IF multiple tables remain AND question is metrics-only (no breakdown):
  * Example: "What is total revenue?", "Overall cost for PBM"
  * SELECT table where high_level_table=true
  
- IF multiple tables have BOTH required metrics AND attributes (tie scenario):
  * Check if one table has high_level_table=true
  * SELECT the high_level_table as primary choice
  * Example: Both Claims and Ledger have revenue + client_name, Ledger has high_level=true → Select Ledger
  
- IF question needs breakdown but only one table has all requirements:
  * Select that table regardless of high_level_table flag

**RULE 9: FINAL DECISION**
Count tables that passed all rules:
- SINGLE table passes → Return status="success"
- MULTIPLE tables pass with same metrics + attributes:
  * FIRST: Check if one has high_level_table=true → SELECT it
  * SECOND: Check "useful_for" field as tiebreaker
  * THIRD: Still tied → Return status="needs_disambiguation"
- NO tables pass → Return status="missing_items"

====================================================
EXAMPLES FOR CLARITY
====================================================

Example 1: "What is total revenue?"
- Rule 3: Extract metric=revenue, no attributes
- Rule 6: Metrics-only query, multiple tables have revenue
- Decision: Select high_level_table=true (Ledger)

Example 2: "Show revenue breakdown by drug"
- Rule 3: Extract metric=revenue, attribute=drug_name
- Rule 5: Ledger lacks drug_name → ELIMINATE
- Decision: Select Claims (has both)

Example 3: "Revenue by client"  // NEW EXAMPLE
- Rule 3: Extract metric=revenue, attribute=client_name
- Rule 5: Both Ledger and Claims have revenue + client_name
- Rule 9: Tie scenario → Ledger has high_level_table=true
- Decision: Select Ledger (high_level tiebreaker)

Example 4: "MPDOVA billed amount"
- Rule 3: Extract metric=billed_amount, filter=MPDOVA
- Rule 7: MPDOVA found only in carrier_name
- Decision: Auto-select carrier_name column
