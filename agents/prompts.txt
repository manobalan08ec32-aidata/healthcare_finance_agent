async def search_column_values(
        self,
        search_terms: List[str],
        column_index: Dict[str, Any],
        max_columns: int = 7,
        max_values_per_column: int = 5
    ) -> List[str]:
        """
        Search for values across columns with tiered matching and scoring.
        
        Priority Order:
            Tier 1: Exact match (full term matches value exactly)
            Tier 2: Prefix match (value starts with term)
            Tier 3: Contains match (term found within value)
        
        Scoring:
            - Values matching more search terms rank higher
            - Full phrase match scores higher than individual words
        
        Args:
            search_terms: List of values to search (e.g., ["covid vaccine", "ozempic"])
            column_index: Loaded index dictionary
            max_columns: Maximum columns to return (default 7)
            max_values_per_column: Maximum matched values per column (default 5)
            
        Returns:
            List of formatted strings: ["column_name - value1, value2", ...]
        """
        
        if not search_terms:
            return []
        
        columns_data = column_index.get("columns", {})
        
        if not columns_data:
            print("‚ö†Ô∏è No columns data found in column index")
            return []
        
        # Build search list: full phrases + individual words
        # Structure: [(term, priority_weight), ...]
        # Full phrase gets weight 10, individual words get weight 5
        search_items = []
        
        for term in search_terms:
            term_lower = term.strip().lower()
            if not term_lower:
                continue
            
            # Add full phrase with high weight
            search_items.append({"term": term_lower, "weight": 10, "is_phrase": True})
            
            # Add individual words with lower weight
            words = term_lower.split()
            if len(words) > 1:
                for word in words:
                    if len(word) > 2:  # Skip very short words
                        # Avoid duplicates
                        if not any(s["term"] == word for s in search_items):
                            search_items.append({"term": word, "weight": 5, "is_phrase": False})
        
        print(f"üîç Search items: {[(s['term'], s['weight']) for s in search_items]}")
        
        # Track results per column
        # Structure: {column_name: {"tier": int, "values": {value: {"tier": int, "score": int}}}}
        column_matches = {}
        
        # Process each column
        for col_name, values in columns_data.items():
            
            for value in values:
                value_tier = None
                value_score = 0
                matched_terms = []
                
                # Check each search term against this value
                for search_item in search_items:
                    term = search_item["term"]
                    weight = search_item["weight"]
                    
                    # Determine match type for this term-value pair
                    match_type = None
                    
                    if value == term:
                        # Exact match
                        match_type = "exact"
                        term_tier = 1
                    elif value.startswith(term):
                        # Prefix match
                        match_type = "prefix"
                        term_tier = 2
                    elif term in value:
                        # Contains match
                        match_type = "contains"
                        term_tier = 3
                    
                    if match_type:
                        matched_terms.append(term)
                        value_score += weight
                        
                        # Keep best (lowest) tier for this value
                        if value_tier is None or term_tier < value_tier:
                            value_tier = term_tier
                
                # If value matched any term, record it
                if value_tier is not None:
                    if col_name not in column_matches:
                        column_matches[col_name] = {"best_tier": value_tier, "values": {}}
                    
                    # Update column's best tier
                    if value_tier < column_matches[col_name]["best_tier"]:
                        column_matches[col_name]["best_tier"] = value_tier
                    
                    # Store value with its tier and score
                    column_matches[col_name]["values"][value] = {
                        "tier": value_tier,
                        "score": value_score,
                        "matched_terms": matched_terms
                    }
        
        # Now filter: if exact match exists for a term, remove partial matches for that term
        # Find terms that have exact matches somewhere
        terms_with_exact = set()
        for col_name, col_data in column_matches.items():
            for value, value_info in col_data["values"].items():
                if value_info["tier"] == 1:
                    # This value is an exact match, so the term equals the value
                    terms_with_exact.add(value)
        
        print(f"‚úÖ Terms with exact matches: {terms_with_exact}")
        
        # Filter out partial matches for terms that have exact matches
        if terms_with_exact:
            for col_name, col_data in column_matches.items():
                values_to_remove = []
                
                for value, value_info in col_data["values"].items():
                    if value_info["tier"] > 1:  # Partial match
                        # Check if all matched terms for this value have exact matches elsewhere
                        matched_terms = value_info["matched_terms"]
                        if all(term in terms_with_exact for term in matched_terms):
                            values_to_remove.append(value)
                
                for value in values_to_remove:
                    del col_data["values"][value]
                
                # Recalculate best tier after removal
                if col_data["values"]:
                    col_data["best_tier"] = min(v["tier"] for v in col_data["values"].values())
        
        # Remove columns with no values left
        column_matches = {k: v for k, v in column_matches.items() if v["values"]}
        
        # Sort columns by best_tier, then by best value score within column
        def column_sort_key(item):
            col_name, col_data = item
            best_tier = col_data["best_tier"]
            # Best score among values in this column
            best_score = max(v["score"] for v in col_data["values"].values())
            return (best_tier, -best_score, col_name)
        
        sorted_columns = sorted(column_matches.items(), key=column_sort_key)
        
        # Format output
        results = []
        for col_name, col_data in sorted_columns[:max_columns]:
            # Sort values within column: by tier (asc), then score (desc)
            sorted_values = sorted(
                col_data["values"].items(),
                key=lambda x: (x[1]["tier"], -x[1]["score"])
            )
            
            # Take top N values
            top_values = [v[0] for v in sorted_values[:max_values_per_column]]
            values_str = ", ".join(top_values)
            
            best_tier = col_data["best_tier"]
            best_score = max(v["score"] for v in col_data["values"].values())
            
            results.append(f"{col_name} - {values_str}")
            print(f"   Tier {best_tier}, Score {best_score}: {col_name} ‚Üí {top_values}")
        
        print(f"‚úÖ Search complete: Found {len(results)} matching columns")
        return results
```

---

## Example Walkthrough

**Input:** `["covid vaccine"]`

**Search items built:**
```
[("covid vaccine", 10), ("covid", 5), ("vaccine", 5)]
```

**Processing value `"covid-19 vaccines"`:**
```
- "covid vaccine" in "covid-19 vaccines"? YES (contains) ‚Üí tier 3, score +10
- "covid" in "covid-19 vaccines"? YES (contains) ‚Üí tier 3, score +5
- "vaccine" in "covid-19 vaccines"? YES (contains) ‚Üí tier 3, score +5

Result: tier=3, score=20, matched_terms=["covid vaccine", "covid", "vaccine"]
```

**Processing value `"covidien m"`:**
```
- "covid vaccine" in "covidien m"? NO
- "covid" in "covidien m"? YES (contains) ‚Üí tier 3, score +5
- "vaccine" in "covidien m"? NO

Result: tier=3, score=5, matched_terms=["covid"]
```

**Final ranking:**
```
1. therapy_class_name - covid-19 vaccines (Tier 3, Score 20) ‚Üê TOP
2. drug_name - covid-19 flu a+b test kit (Tier 3, Score 15)
3. DRUG_MANUFCTR_NM - covidien m (Tier 3, Score 5) ‚Üê LOWER
