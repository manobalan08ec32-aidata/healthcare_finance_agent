SQL_FOLLOWUP_VALIDATION_PROMPT = """TASK: Classify the user's follow-up response to determine the next action.

CONTEXT:
- ORIGINAL USER QUESTION: {current_question}
- SELECTED DATASET: {selected_dataset_name}

CLARIFICATION EXCHANGE:
- YOUR PREVIOUS QUESTION: {sql_followup_question}
- USER'S RESPONSE: {sql_followup_answer}

CLASSIFICATION RULES:

1. **VALID_ANSWER**: Response helps proceed with SQL generation
   - Affirmative: "yes", "ok", "proceed", "looks good", "approved", "confirm"
   - Selects from offered options OR provides alternative values of the SAME TYPE from the follow up question
     (e.g., asked about July comparison, user says "nov vs dec" â†’ still answering about months)
   - Grouping preference: "show separately", "break it down", "by each"
   Key: Response is RELEVANT to clarification topic, even if values differ from options

2. **NEW_QUESTION**: User asks a completely different question instead of answering
   - Ignores the clarification and asks about a DIFFERENT TOPIC entirely
   - Examples: Clarification was about time period, user asks about a different metric or different analysis
   - Key indicator: Question mark with new analytical intent on UNRELATED topic

3. **TOPIC_DRIFT**: User's response is off-topic or nonsensical
   - Response doesn't relate to business context at all
   - Examples: Random text, non-business content, greetings without answer, completely unrelated response
   - Key: NO connection to the clarification topic or business analysis

IMPORTANT: If user provides alternative values for the SAME TYPE of question (e.g., different months when asked about months), classify as VALID_ANSWER, not TOPIC_DRIFT.

OUTPUT FORMAT (return ONLY this XML, no other text):
<validation>
<classification>[VALID_ANSWER|NEW_QUESTION|TOPIC_DRIFT]</classification>
<reasoning>[1 sentence explaining classification]</reasoning>
</validation>
"""
