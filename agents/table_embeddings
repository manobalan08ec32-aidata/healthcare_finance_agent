# hypothesis_catalog.yaml - Comprehensive investigation patterns
investigation_patterns:
  revenue_change:
    mandatory_checks:
      - name: overall_magnitude
        description: "Assess overall revenue change magnitude and timing"
        dataset: ledger_overview
        group_set: "by line of business"
        priority: 1
        
      - name: volume_price_decomposition
        description: "Split revenue into volume and price components"
        dataset: claims_drivers
        metrics: ["revenue_amt", "unadjusted_script_count"]
        calculation: "revenue_per_script"
        priority: 2
        
      - name: temporal_pattern
        description: "Check for seasonal or cyclical patterns"
        dataset: ledger_overview
        time_analysis: true
        priority: 3
    
    investigation_factors:
      client_factors:
        - name: client_churn
          description: "Check for lost clients"
          dataset: claims_drivers
          group_set: "by client"
          analysis_type: "retention"
          priority: 1
          
        - name: client_additions
          description: "Check for new client additions"
          dataset: claims_drivers
          group_set: "by client"
          analysis_type: "new_business"
          priority: 2
          
      member_factors:
        - name: membership_changes
          description: "Analyze member count changes"
          dataset: claims_drivers
          metrics: ["member_count", "eligibility_status"]
          analysis_type: "cohort"
          priority: 1
          
        - name: member_demographics
          description: "Check age group shifts"
          dataset: claims_drivers
          group_set: "by age group"
          priority: 2
          
      carrier_factors:
        - name: carrier_changes
          description: "Analyze carrier additions or drops"
          dataset: claims_drivers
          group_set: "by carrier"
          analysis_type: "retention"
          priority: 1
          
      product_factors:
        - name: brand_generic_mix
          description: "Analyze brand vs generic shifts"
          dataset: claims_drivers
          group_set: "by brand vs generic and drug combination"
          priority: 1
          
        - name: therapy_class_mix
          description: "Check therapy class changes"
          dataset: claims_drivers
          group_set: "by therapy drug"
          priority: 2
          
      operational_factors:
        - name: pharmacy_network
          description: "Analyze pharmacy performance"
          dataset: claims_drivers
          group_set: "by pharmacy"
          priority: 1
          
        - name: claim_processing
          description: "Check claim status patterns"
          dataset: claims_drivers
          metrics: ["claim_status_code", "rejection_rate"]
          priority: 2

  script_volume_change:
    mandatory_checks:
      - name: overall_script_trend
        description: "Overall script volume trend"
        dataset: claims_drivers
        metrics: ["unadjusted_script_count"]
        priority: 1
        
      - name: scripts_per_member
        description: "Scripts per member analysis"
        dataset: claims_drivers
        calculation: "scripts_per_member"
        priority: 2
        
    investigation_factors:
      # Similar structure for script-specific investigations
      
  membership_change:
    mandatory_checks:
      - name: overall_membership
        description: "Total membership trend"
        dataset: ledger_overview
        metrics: ["Total Membership"]
        priority: 1
        
    investigation_factors:
      # Membership-specific factors

investigation_rules:
  max_total_iterations: 7
  min_iterations: 3
  variance_threshold: 70
  confidence_threshold: 0.8
  stop_conditions:
    - variance_explained: 80
    - no_progress_iterations: 2
    - confidence_reached: 0.9
  iteration_limits:
    per_hypothesis: 2
    per_dimension: 3
    mandatory_completion_required: true
